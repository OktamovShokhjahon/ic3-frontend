(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[615],{1385:function(e,t,s){Promise.resolve().then(s.bind(s,1258))},1258:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var l=s(7437),a=s(2265),n=s(4033),r=s(8222);function i(e){let{params:t}=e,[s,i]=(0,a.useState)(null),[o,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(null),[m,h]=(0,a.useState)([]),[x,g]=(0,a.useState)(0),[f,b]=(0,a.useState)(!0),[v,p]=(0,a.useState)(!1),[y,N]=(0,a.useState)(0),[w,j]=(0,a.useState)(null),[k,S]=(0,a.useState)(!1),[E,L]=(0,a.useState)(0),[C,F]=(0,a.useState)(null),q=(0,n.useRouter)();(0,a.useEffect)(()=>{A()},[]),(0,a.useEffect)(()=>{if(v&&y>0){let e=setTimeout(()=>N(y-1),1e3);return()=>clearTimeout(e)}0===y&&v&&T()},[y,v]),(0,a.useEffect)(()=>{let e=()=>{v&&document.hidden&&(L(e=>e+1),E>=2&&T())},t=()=>{v&&(L(e=>e+1),E>=2&&T())},s=e=>(e.preventDefault(),!1),l=e=>(e.preventDefault(),!1),a=e=>{if(e.ctrlKey&&("c"===e.key||"v"===e.key||"x"===e.key)||"F12"===e.key||e.ctrlKey&&e.shiftKey&&"I"===e.key)return e.preventDefault(),!1};return v&&(document.addEventListener("visibilitychange",e),window.addEventListener("blur",t),document.addEventListener("contextmenu",s),document.addEventListener("copy",l),document.addEventListener("keydown",a)),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("blur",t),document.removeEventListener("contextmenu",s),document.removeEventListener("copy",l),document.removeEventListener("keydown",a)}},[v,E]);let A=async()=>{try{let e=await r.Z.get("/auth/me");i(e.data.user)}catch(e){q.push("/login")}finally{b(!1)}},D=async()=>{try{let e=document.documentElement;e.requestFullscreen?await e.requestFullscreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.msRequestFullscreen&&await e.msRequestFullscreen(),S(!0)}catch(e){console.error("Fullscreen request failed:",e)}},I=async e=>{try{if(await D(),"1"===t.level&&"1-45"===e){F("/lvl-1-1/index.html"),u(e),p(!0),j(Date.now()),N(2700);return}if("1"===t.level&&"46-90"===e){F("/lvl-1-2/index.html"),u(e),p(!0),j(Date.now()),N(2700);return}let s=await r.Z.get("/tests/questions/".concat(t.level,"/").concat(e));c(s.data.questions),u(e),h(Array(s.data.questions.length).fill(-1)),p(!0),j(Date.now());let l="full"===e?5400:2700;N(l)}catch(e){console.error("Failed to load questions:",e)}},R=(e,t)=>{let s=[...m];s[e]=t,h(s)},T=async()=>{if(!w||!d)return;let e=Math.floor((Date.now()-w)/1e3);try{let s=await r.Z.post("/tests/submit",{level:parseInt(t.level),type:d,questionIds:o.map(e=>e._id),answers:m,timeSpent:e});q.push("/results?data=".concat(encodeURIComponent(JSON.stringify(s.data.result))))}catch(e){console.error("Failed to submit test:",e)}};if(f)return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-white",children:"Loading..."})});if(!s)return null;if(!v)return(0,l.jsxs)("div",{className:"relative min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:[s&&(0,l.jsx)("div",{className:"pointer-events-none select-none fixed inset-0 opacity-25 z-50",children:(0,l.jsx)("div",{className:"relative w-full h-full",children:Array.from({length:5}).map((e,t)=>Array.from({length:5}).map((e,a)=>{var n,r;let i=10+20*a;return(0,l.jsxs)("div",{className:"absolute text-2xl md:text-3xl font-semibold tracking-wide text-gray-700 whitespace-nowrap",style:{top:"".concat(10+20*t,"%"),left:"".concat(i,"%"),transform:"translate(-50%, -50%) rotate(-20deg)"},children:[null!==(n=s.passportFullName)&&void 0!==n?n:s.username," \xb7 ",null!==(r=s.passportNumber)&&void 0!==r?r:"N/A"]},"".concat(t,"-").concat(a))}))})}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-2xl backdrop-blur-lg bg-opacity-95",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsxs)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:["Level ",t.level," Test"]}),(0,l.jsx)("p",{className:"text-gray-600",children:"Choose your test type"})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{type:"1-45",label:"Questions 1-45",desc:"First half of the test"},{type:"46-90",label:"Questions 46-90",desc:"Second half of the test"},{type:"full",label:"Full Practice",desc:"All 90 questions"}].map(e=>(0,l.jsxs)("button",{onClick:()=>I(e.type),className:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-xl hover:from-blue-600 hover:to-indigo-700 transition transform hover:scale-105",children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-2",children:e.label}),(0,l.jsx)("p",{className:"text-sm opacity-90",children:e.desc})]},e.type))}),(0,l.jsx)("div",{className:"mt-8 text-center",children:(0,l.jsx)("button",{onClick:()=>q.push("/dashboard"),className:"text-gray-600 hover:text-gray-800 transition",children:"← Back to Dashboard"})})]})]});if(C){let e="1-45"===d?"Questions 1–45":"46-90"===d?"Questions 46–90":"Legacy Test";return(0,l.jsxs)("div",{className:"relative min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-0",children:[s&&(0,l.jsx)("div",{className:"pointer-events-none select-none fixed inset-0 opacity-25 z-50",children:(0,l.jsx)("div",{className:"relative w-full h-full",children:Array.from({length:5}).map((e,t)=>Array.from({length:5}).map((e,a)=>{var n,r;let i=10+20*a;return(0,l.jsxs)("div",{className:"absolute text-2xl md:text-3xl font-semibold tracking-wide text-gray-700 whitespace-nowrap",style:{top:"".concat(10+20*t,"%"),left:"".concat(i,"%"),transform:"translate(-50%, -50%) rotate(-20deg)"},children:[null!==(n=s.passportFullName)&&void 0!==n?n:s.username," \xb7 ",null!==(r=s.passportNumber)&&void 0!==r?r:"N/A"]},"".concat(t,"-").concat(a))}))})}),(0,l.jsxs)("div",{className:"relative z-10 h-screen flex flex-col",children:[(0,l.jsxs)("div",{className:"bg-white rounded-b-2xl shadow-lg p-4 flex justify-between items-center",children:[(0,l.jsx)("div",{className:"flex items-center space-x-4",children:(0,l.jsxs)("span",{className:"text-lg font-semibold",children:["Level ",t.level," – IC3 GS6 (",e,")"]})}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"text-lg font-mono",children:[Math.floor(y/60),":",(y%60).toString().padStart(2,"0")]}),(0,l.jsx)("button",{onClick:async()=>{if(!w){q.push("/dashboard");return}let e=Math.floor((Date.now()-w)/1e3);try{let s=await r.Z.post("/tests/legacy-complete",{level:parseInt(t.level,10),type:null!=d?d:"1-45",timeSpent:e});q.push("/results?data=".concat(encodeURIComponent(JSON.stringify(s.data.result))))}catch(e){console.error("Failed to record legacy test result:",e),q.push("/dashboard")}},className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition",children:"Exit"})]})]}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("iframe",{src:C,className:"w-full h-full border-0",title:"IC3 GS6 Level 1 Test",sandbox:"allow-scripts allow-same-origin allow-forms"})})]})]})}let _=o[x];return(0,l.jsxs)("div",{className:"relative min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:[s&&(0,l.jsx)("div",{className:"pointer-events-none select-none fixed inset-0 opacity-25 z-50",children:(0,l.jsx)("div",{className:"relative w-full h-full",children:Array.from({length:5}).map((e,t)=>Array.from({length:5}).map((e,a)=>{var n,r;let i=10+20*a;return(0,l.jsxs)("div",{className:"absolute text-xl md:text-2xl font-semibold tracking-wide text-gray-700 whitespace-nowrap",style:{top:"".concat(10+20*t,"%"),left:"".concat(i,"%"),transform:"translate(-50%, -50%) rotate(-20deg)"},children:[null!==(n=s.passportFullName)&&void 0!==n?n:s.username," \xb7 ",null!==(r=s.passportNumber)&&void 0!==r?r:"N/A"]},"".concat(t,"-").concat(a))}))})}),E>0&&(0,l.jsxs)("div",{className:"bg-red-500 text-white p-4 text-center",children:["⚠️ Warning ",E,"/3: Do not switch tabs or leave fullscreen! Test will be auto-submitted."]}),(0,l.jsxs)("div",{className:"bg-white rounded-t-2xl shadow-lg p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("span",{className:"text-lg font-semibold",children:["Question ",x+1,"/",o.length]}),(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:["Level ",t.level," - ",d]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"text-lg font-mono",children:[Math.floor(y/60),":",(y%60).toString().padStart(2,"0")]}),(0,l.jsx)("button",{onClick:T,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition",children:"Submit Test"})]})]}),(0,l.jsx)("div",{className:"mt-4 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat((x+1)/o.length*100,"%")}})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-4",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:_.question}),(0,l.jsx)("div",{className:"space-y-4",children:_.options.map((e,t)=>(0,l.jsx)("button",{onClick:()=>R(x,t),className:"w-full text-left p-4 rounded-lg border-2 transition ".concat(m[x]===t?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-6 h-6 rounded-full border-2 mr-3 flex items-center justify-center ".concat(m[x]===t?"border-blue-500 bg-blue-500":"border-gray-300"),children:m[x]===t&&(0,l.jsx)("div",{className:"w-3 h-3 bg-white rounded-full"})}),(0,l.jsx)("span",{className:"text-lg",children:e})]})},t))})]}),(0,l.jsx)("div",{className:"bg-white rounded-2xl shadow-lg p-4",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("button",{onClick:()=>g(Math.max(0,x-1)),disabled:0===x,className:"bg-gray-500 hover:bg-gray-600 disabled:bg-gray-300 text-white px-6 py-2 rounded-lg transition",children:"Previous"}),(0,l.jsx)("div",{className:"flex space-x-2",children:o.map((e,t)=>(0,l.jsx)("button",{onClick:()=>g(t),className:"w-8 h-8 rounded-full text-sm ".concat(-1!==m[t]?"bg-green-500 text-white":x===t?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"),children:t+1},t))}),(0,l.jsx)("button",{onClick:()=>g(Math.min(o.length-1,x+1)),disabled:x===o.length-1,className:"bg-gray-500 hover:bg-gray-600 disabled:bg-gray-300 text-white px-6 py-2 rounded-lg transition",children:"Next"})]})})]})}},8222:function(e,t,s){"use strict";let l=s(4829).Z.create({baseURL:"http://77.83.206.105:5000/api",withCredentials:!0});l.interceptors.request.use(e=>{{let s=localStorage.getItem("deviceId");if(s){var t;e.headers=null!==(t=e.headers)&&void 0!==t?t:{},e.headers["x-device-id"]=s}}return e}),t.Z=l}},function(e){e.O(0,[600,971,938,744],function(){return e(e.s=1385)}),_N_E=e.O()}]);